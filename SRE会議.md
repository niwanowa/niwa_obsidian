### Re:Define 可用性を支えるモニタリング、パフォーマンス最適化、そしてセキュリティ

CPU使用率95%のアラートは妥当か？
-> ものによるよね

セマンティック監視

4大シグナル
1. レイテンシ
2. トラフィック
3. エラー
4. サチュレーション

クラウドの弾力性やスケーリングを踏まえるとCPUの飽和などはただのノイジーアラート

無視できるアラートは出すな 
入門監視でもそう言ってる

Mackerelのcommand句
https://beyondjapan.com/blog/2019/01/first-mackerel/
これっぽい

オブザーバビリティを高めるには
それぞれのテレメトリーが相互にリンクされており、掘り進めるように調査できるようにする
自動軽装に加えて手動軽装も追加する
テレメトリデータを取得する

障害調査しているときに次の障害の助けになる実装を追加する

木こりのジレンマ、トイルの話
これ、知ってる話だ！！

システムのパフォーマンス・チューニング
金で殴るのはSRE視点では「負け」

アプリケーションのパフォーマンス・チューニング
テレメトリデータを拡充
APMサービスの導入

SREと開発チームの」役割分担
SREがパフォーマンス改善の調査を担当
実際のコード改修は

ダッシュボードの活用

結局全部できればいいので日々精進
計算量、道具を磨く
エディターの設定
strace、tcpdump

引き出しを増やす

Linuxの仕組みを理解する
カーネルチューニングやプロセス間通信の理解でシステム全体のパフォーマンス向上
バッファ管理やカーネルパラメータの意味を理解したい

趣味開発を通じたスキル向上
自分しか使わないものを作ってみる

セキュリティインシデントが発生したとき
ログの保全
	監査ログやデータベースクエリログを収集
ストリーミングの活用

リストアの検証
実践的なシミュレーション

余談： 障害対応
根本対応をいかに早く行うかが重要
暫定対応のリスク：

### 一人から始めたSREチーム3年間の歩み -求められるスキルの変化とチームのあり方-

1人目のスキルセット
浅くても広い経験
カオスな状況を整えられる必要がある

SREについてプロダクトチームに理解してもらう
ドキュメントを残すことを意識していた。

アラートの設計からやり直した
(全件チャンネルに流してた)

ミッション&ビジョンは早めに作っておきたい
ソフトウェアエンジニアがプロダクトの信頼性と開発速度を最大化する活動ができる状態を作る

SREとはどういう役割なのか、何をするのか布教活動
現場が苦しんでいる部分を積極的に拾い上げていく

チーム拡大機
ロードマップとプロダクトからの依頼に対応するがバランスが難しい
チームビルディング
他者評価


ミッションがなんで必要化
アプローチや解決の方針はミッションによって変わる
意思決定の軸にミッションの存在が役立つ

SRE以外が運用可能な状態を成果として仕上げたい
SRE活動に必要な基礎土台構築（SLO、文化醸成など）

チーム安定期
やるべきことに取り組みながら、チャレンジもする
オンボーディングフローの向上

繰り返しを回避するためのツール群を開発

postmortemのロールプレイ研修
組織が大規模化すると関係性が希薄に
->リリース情報を把握できなくなった、プロダクトの懸念事項を把握できなくなった

四半期に1回のSLO再定義
フォーマットの統一

3年で変わったこと、変わらないこと
ミッションは変えない
SREの対応方法、フェーズで必要な人材が異なるのは仕方ない

自分が最も輝く瞬間がどこなのかは考えておいて損はない

違う特性を持った人がいるの良いこと
### もっとSREの裾野を広げるための初学者向け技術研修設計

求められるスキルが幅広いのでどこから手を付けていいかわからん
SREロールの固定化
特定の人々がロールとして全部やりがち

SREは生き様だろ
サイトを運用していくなら当たり前として...
いわゆるOJTでは学習が起こるタイミングが偶然に依存する
SREが成熟に伴い、簡単な課題が発生する確率が下がる
googd first issueがこかるするのでは...?

これらを研修で解決したい。
ペパボの新卒研修
概要
技術研修を数ヶ月間行う
テックブログに書いているので後で見る
研修の効能 ： 組織社会化/組織への技術浸透

コンテナ研修
・コンテナの基礎知識からk8s、社内で使われるCICDツールまでを習得
オブザーバビリティ研修
大まかに次の内容
・メトリクスを収集、可視化しよう
・ログを収集、可視化しよう

「教わったプラクティスの拡散」

パフォーマンス・チューニング実践
private-isuを使わせてもらっている

研修設計時に考慮したこと
教室  vs 実践
教育言説はどっちも振り子のように行き交っている

How vs Why
具体的、短期的な技能と抽象的な技能
kubectlでクラスタ操作ができる。k8sがどのような課題を解決するのか説明できる
->両方取得したい...!

座学は一瞬、ほとんどの時間は実践
必要な知識は文書化しておいておく
ペパボでは「アウトプットすること」を重視
成果物の解説を課題として設定する
人に伝わるように出力することで習得が深まる

Why -> how -> why
まず技術へのモチベーションを導入し、習得した技術に腹落ちさせる
1.これから扱う技術の背景を最初に導入する
2.手を動かしてHowを習得する
3.Howを踏まえて再度Whyを問う

エンジニアの寿命はシステムの寿命より短い
オブザーバビリティエンジニアリングを読む

実践時間の見積もりが難しい

オンボーディング時のトレーニング
ツールのハンズオン
	検証環境を作って壊してみるハンズオン
ポストモーテム
	障害対応後は、オンボーディング車がシステムへの理解を深めるチャンス
プレモーテム
	障害を想定して対応を考えてみる作業を指す
		チーム内で出題者と回答者に分かれる

効果歴だった教材
SRE がざっくりすっきり分かる本
SRE何もわからないから役に立つ
100ページかからないので読めってやってもよい

ワークショップ「the art of SLOs」
SLI,SLOを策定する演習がメインの

自宅サーバー
ミニPCのwindows消し飛ばしてUbuntuを入れる

### 信頼性を支えるテレメトリーパイプラインの構築
13:35 - 14:05

テレメトリーパイプラインの構築

オブザーバビリティの中のニッチな話 -> テレメトリーパイプライン

k8sによる構築まで高度化して初めてテレメトリーに悩むことになりそう

### SREとしてスタッフエンジニアを目指す
16:35 - 17:05

スタッフエンジニアとは
重要なのは技術力だけでなく貨車への貢献度
上司だけでなく、チームメンバーや外チームからの信頼も重要

スタッフエンジニアになると何が嬉しい？
影響力、責任が増える
より大きく・長期的で不確実な課題に取り組む

テックリード・アーキテクトの役割を求められる
共通のインフラやシステムに関わる
エンジニア組織全体に関わることが期待されている
・(日本では)専任のPMが不在のことが多い

SREのスタッフエンジニアの役割
組織の信頼性を導く技術リーダ医
1. 信頼性に関する問題解決と意思決定
2. 組織的な信頼性の基準と文化づくり
3. 

単語：インシデントコマンダー
プロジェクトの例
EC2->k8s

->SREのリーダーをやっていれば組織全体に関わるプロジェクトをリードすることになるので自動的にスタッフになるのでは

Staff SREに求められる能力
技術力と実行力
コミュニケーションと信頼感
戦略的な思考

スタッフエンジニアになるために
階段を登る
	問題を解決する
	少しずつ成長する
	少しずつ大きな問題に挑戦する
	少しずつ信頼を得る

信頼を得るには問題を解決するしかない

担当するシステムにおいて、わからないことをなくしていこう
システム全体を見渡せる広い知識に加えて、自分の得意な分野を作ろう

ドキュメントを書いてチームに知識を共有

システムの信頼性のオーナーとしての意識を持つ
### コード化されていない稼働中のサーバを移設/再構築する技術
17:10 - 17:40

IaCの重要性
EC2を建てて、サーバが何らかの原因で壊れると、再構築が必要
シンプルな構成ならすぐに直せそうだが複雑な構成だと復旧させるまでに時間がかかる
->再現性の向上、リスク軽減と迅速な復旧

コード化されていない稼働中のサーバを移設/再構築する
サービスは動いてるしトラフィックもすごい量捌いている
サーバ台数も300台近い
脆弱性の観点からOSの以降が必須となった
アプリケーションもgit管理されていなかった


既存環境のコード化
インフラの設計書があればその通りにコードを書いていけば良い
インフラは設計書が残っているケースは少ない
手動で構築されたサーバをどうにかしてOSを移管する

動いているものを正として構成を把握する
手始めに実施する系
ホスト名
NIC IPアドレスからサブネットがわかる
複数NICある場合はそこからネットワーク構成がみれるケースも
OS /etc/os-release
動いているプロセスをみる
	プロセス名から大体の予想がつく
	空いてるポート番号なども調べておく
	CPU、メモリ、ストレージを見る
		大量にCPUが積まれている場合はCPUバウンドな処理がある
入っているパッケージの調査
RPMやAPTでいつ入ったのかやどこのリポジトリから取ってきているのか、どういった第るを使っているのかを確認

具体的な調査
	アプリケーションを読んでいく
	-  LL言語の場合
	- ミドルウェアの情報をまとめていく
	- どこかにコードが落ちていればそのコードを読んでいく
	- ソースがある場合でも新しいOSでブルドできるとは限らない

動いているプロセスの特徴を調べていく
	- procfs
		ライブラリのリンク情報もわかる
		メモリアドレス範囲、アクセス権、ファイルパス
		どのようなミドルウェアに依存していのかがある程度把握することができる
		ログ・ファイルの場所やその他に書き込んでいるファイルを特定できる
		使っているポート番号も特定できる
	- sysfs
		デバイスやドライバについての情報を含んでいる
	- tcpdumpネットワークパケットをキャプチャし分析するためのCLI津0る
		- プロセスが使っているポートに対して実行する
	- strace
		システムコールレベルでプログラムの挙動を把握するためのツール
	- ltrace
		プログラムが実行する...
	-ftrace
		カーネル関数の呼び出しをトレースする
		